{% set name = "transformers" %}
{% set version = "4.40.2" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 657b6054a2097671398d976ad46e60836e7e15f9ea9551631a96e33cb9240649

build:
  skip: True  # [py<38]
  number: 0
  script: {{ PYTHON }} -m pip install . --no-deps --no-build-isolation -vv
  entry_points:
    - transformers-cli=transformers.commands.transformers_cli:main

requirements:
  host:
    - pip
    - python
    - setuptools
    - wheel
  run:
    - python
    - filelock
    - huggingface_hub >=0.19.3,<1
    - numpy >=1.17
    - packaging >=20.0
    - pyyaml >=5.1
    - regex !=2019.12.17
    - requests
    - safetensors >=0.4.1
    - tokenizers >=0.19,<0.20
    - tqdm >=4.27
  run_constrained:
    # all extra dependencies except 'testing'
    - pillow >=10.0.1,<=15.0
    - accelerate >=0.21.0
    - av ==9.2.0
    - codecarbon ==1.2.0
    - cookiecutter ==1.7.3
    - datasets !=2.5.0
    - decord ==0.6.0
    - deepspeed >=0.9.3
    - dill <0.3.5
    - evaluate >=0.2.0
    - flax >=0.4.1,<=0.7.0
    - fsspec <2023.10.0
    - fugashi >=1.0
    - GitPython <3.1.19
    - hf-doc-builder >=0.3.0
    - ipadic >=1.0.0,<2.0
    - isort >=5.5.4
    - jax >=0.4.1,<=0.4.13
    - jaxlib >=0.4.1,<=0.4.13
    - keras <2.16
    - keras-nlp >=0.3.1
    - natten >=0.14.6,<0.15.0
    - onnxruntime-tools >=1.4.2
    - onnxruntime >=1.4.0
    - optax >=0.0.8,<=0.1.4
    - ray-tune >=2.7.0
    - rhoknp >=1.1.0,<1.3.1
    - ruff ==0.1.5
    - sagemaker >=2.31.0
    - sentencepiece >=0.1.91,!=0.1.92
    - sudachipy >=0.6.6
    - sudachidict_core >=20220729
    - tensorflow-cpu >=2.6,<2.16
    - tensorflow >=2.6,<2.16
    - tensorflow-text <2.16
    - pyctcdecode >=0.4.0
    - unidic >=1.0.2
    - unidic_lite >=1.0.7
    - urllib3 <2.0.0

test:
  requires:
    - pip
    # to satisfy `transformers-cli --help` because it raises a warning of missing pytorch/tensorflow/flax for models.
    # skip ppc64le because of lack of pytorch
    - pytorch  # [not (linux and ppc64le)]
  imports:
    - transformers
    - transformers.benchmark
    - transformers.commands
    - transformers.data
    - transformers.generation
    - transformers.integrations
    - transformers.models
    - transformers.onnx
    - transformers.pipelines
    - transformers.quantizers
    - transformers.sagemaker
    - transformers.tools
    - transformers.utils
  commands:
    - pip check
    - transformers-cli --help

about:
  home: https://github.com/huggingface/transformers
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE
  summary: State-of-the-art Machine Learning for JAX, PyTorch and TensorFlow
  description: |
    Transformers provides thousands of pretrained models to perform tasks on different modalities such as text, vision, and audio.

    These models can be applied on:

    - 📝 Text, for tasks like text classification, information extraction, question answering, summarization, translation, text generation, in over 100 languages.
    - 🖼️ Images, for tasks like image classification, object detection, and segmentation.
    - 🗣️ Audio, for tasks like speech recognition and audio classification.

    Transformer models can also perform tasks on several modalities combined, such as table question answering, optical character recognition, information extraction from scanned documents, video classification, and visual question answering.
  doc_url: https://huggingface.co/docs/transformers/index
  dev_url: https://github.com/huggingface/transformers

extra:
  recipe-maintainers:
    - mxr-conda
    - roccqqck
    - oblute
    - rluria14
    - ndmaxar
    - setu4993
    - hadim
    - wietsedv
  skip-lints:
    - python_build_tool_in_run
